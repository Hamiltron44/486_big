"0","library(dplyr)"
"0","library(ggplot2)"
"0","library(pROC)"
"0","library(caret)"
"0",""
"0","# Fit the linear regression model (lm)"
"0","lm_model <- lm(response ~ watrlvl + cvrd, data = germ_bern)"
"0",""
"0","# Fit the logistic regression model (glm)"
"0","logistic_model <- glm(response ~ watrlvl + cvrd, data = germ_bern, family = binomial)"
"0",""
"0","# Predictions for both models"
"0","lm_pred <- predict(lm_model, type = ""response"")  # Linear regression predictions"
"0","logistic_pred <- predict(logistic_model, type = ""response"")  # Logistic regression predictions"
"0",""
"0","# 1. Accuracy"
"0","# For linear regression: We'll consider predictions > 0.5 as 1, else 0."
"0","lm_pred_class <- ifelse(lm_pred > 0.5, 1, 0)"
"0","logistic_pred_class <- ifelse(logistic_pred > 0.5, 1, 0)"
"0",""
"0","lm_accuracy <- mean(lm_pred_class == germ_bern$response)"
"0","logistic_accuracy <- mean(logistic_pred_class == germ_bern$response)"
"0",""
"0","# 2. AUC (Area Under the ROC Curve) - only valid for logistic regression"
"0","roc_logistic <- roc(germ_bern$response, logistic_pred)"
"2","Setting levels: control = 0, case = 1
"
"2","Setting direction: controls < cases
"
"0","logistic_auc <- auc(roc_logistic)"
"0",""
"0","# 3. R^2 for Linear Regression"
"0","lm_r_squared <- summary(lm_model)$r.squared"
"0",""
"0","# R^2 for Logistic Regression - McFadden's R^2"
"0","logistic_r_squared <- 1 - (logistic_model$deviance / logistic_model$null.deviance)"
"0",""
"0","# Output the results"
"0","cat(""Linear Regression Accuracy:"", lm_accuracy, ""\n"")"
"1","Linear Regression Accuracy:"
"1"," "
"1","0.7044681"
"1"," "
"1","
"
"0","cat(""Logistic Regression Accuracy:"", logistic_accuracy, ""\n"")"
"1","Logistic Regression Accuracy:"
"1"," "
"1","0.7044681"
"1"," "
"1","
"
"0","cat(""Logistic Regression AUC:"", logistic_auc, ""\n"")"
"1","Logistic Regression AUC:"
"1"," "
"1","0.7567812"
"1"," "
"1","
"
"0","cat(""Linear Regression R^2:"", lm_r_squared, ""\n"")"
"1","Linear Regression R^2:"
"1"," "
"1","0.2448274"
"1"," "
"1","
"
"0","cat(""Logistic Regression R^2 (McFadden):"", logistic_r_squared, ""\n"")"
"1","Logistic Regression R^2 (McFadden):"
"1"," "
"1","0.2252255"
"1"," "
"1","
"
